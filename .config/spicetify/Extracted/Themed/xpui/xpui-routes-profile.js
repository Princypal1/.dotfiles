"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[2499],{29664:(e,a,t)=>{t.d(a,{P:()=>g});var i=t(59496),r=t(3793),s=t(80326),o=t(35407),l=t(47262),n=t(95441),d=t(42741),u=t(56672),c=t(11590),m=t(4637);const g=i.memo((function(e){const{images:a,name:t,uri:g,onClick:p,isHero:h,testId:f,index:v,requestId:x,color:b}=e;let y;const k=(0,i.useCallback)((()=>(0,m.jsx)(n.x,{isCircular:!0,isHero:h,images:a,color:b,FallbackComponent:e=>(0,m.jsx)(r.a,{iconSize:64,...e})})),[b,a,h]),j=(0,i.useCallback)((()=>h?(0,m.jsx)(u.k,{children:s.ag.get("card.tag.profile")}):s.ag.get("card.tag.profile")),[h]);return y=h?(0,m.jsx)(d.Z,{index:v,onClick:p,headerText:t,featureIdentifier:"profile",uri:g,isPlayable:!1,renderCardImage:k,renderSubHeaderContent:j,testId:f,requestId:x}):(0,m.jsx)(l.C,{index:v,onClick:p,headerText:t,featureIdentifier:"profile",uri:g,isPlayable:!1,renderCardImage:k,renderSubHeaderContent:j,testId:f,requestId:x}),(0,m.jsx)(o._,{menu:(0,m.jsx)(c.I,{uri:g}),children:y})}))},41200:(e,a,t)=>{t.d(a,{T:()=>c});var i=t(21586),r=t(44979),s=t(96723),o=t(58950),l=t(18805);const n="profile-editImage-imageContainer",d="profile-editImage-editImageButtonContainer";var u=t(4637);const c=function({onClick:e,name:a,images:t,canEdit:c,placeholderType:m,shape:g=l.Kc.SQUARE,dragUri:p=""}){const[h,f]=(0,r.RH)(t),v=(0,s.VO)(h,f)===s.KO.loaded,x=(0,i.O1)([p],a);return(0,u.jsxs)("div",{className:n,"data-testid":`${m}-image`,draggable:!!p,onDragStart:x,children:[(0,u.jsx)(l.Oe,{loading:"eager",name:a,images:t,placeholderType:m,shape:g}),c&&(0,u.jsx)("div",{className:d,children:(0,u.jsx)(o.F,{overlay:v,onClick:e,rounded:g===l.Kc.CIRCLE})})]})}},81186:(e,a,t)=>{t.d(a,{I:()=>s});var i=t(59496),r=t(35708);function s(e,a){const t=(0,r.z)();(0,i.useEffect)((()=>{const i=t.getEvents(),r=e=>a(e);return i.addListener(e,r),()=>{i.removeListener(e,r)}}),[e,t,a])}},33213:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Ma});var i=t(59496),r=t(92053),s=t(6063),o=t(58908),l=t(84875),n=t.n(l),d=t(80326),u=t(29664),c=t(27293),m=t(44223),g=t(15607),p=t(13870);const h="umiKMm5NVr5UeBJCHS6U",f="jzhwZKbfx4vrC_MYd_7c",v="MWWPQQjbjRfoGdPD8D68",x="rMpf7sfaPDcj387_52fA",b="kWCnF32FrVtGHmTy8QeV",y="uJxNEI2k7x8UCDdMKELt",k="wDIZ2yYKjfGI68I4cZ98";var j=t(4637);const I=e=>{const{uri:a}=e,{data:t,loading:i,error:r}=(0,g.J)(p.n5.getFollowers,[a]),s=t?.profiles;return i?(0,j.jsx)(c.h,{hasError:null!==r,errorMessage:d.ag.get("error.not_found.title.page")}):(0,j.jsx)(m.P,{className:n()("contentSpacing",v),title:d.ag.get("followers"),total:s?.length,showAll:!0,children:s?.map(((e,a)=>(0,j.jsx)(u.P,{index:a,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))})},N=e=>{const{uri:a}=e,{data:t,loading:i,error:r}=(0,g.J)(p.n5.getFollowing,[a]),s=t?.profiles;return i?(0,j.jsx)(c.h,{hasError:null!==r,errorMessage:d.ag.get("error.not_found.title.page")}):(0,j.jsx)(m.P,{className:n()("contentSpacing",v),title:d.ag.get("following"),total:s?.length,showAll:!0,children:s?.map(((e,a)=>(0,j.jsx)(u.P,{index:a,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))})};var _=t(90641),P=t(33366),w=t(66152),S=t(17913),R=t(97921),C=t(86431),O=t(81785),T=t(11590),U=t(86417),D=t(41200),A=t(18805),E=t(22984),M=t(53965),F=t(99567),L=t(62738),W=t(53083),H=t(65507),J=t(61922),K=t(6923),B=t(53723),Q=t(44979),G=t(96723);const V="F8_EX1AeKxXNSeh1qiHq",z="valcBm4lLe9qFBcg0sFY",Z="tAIzXn8C9KriGwGuBfWg",q="PsrXxenHUFXYM1ub1xWw",$="U_VWfeeLWnDPhUTxCmrQ",X=function({onClickEdit:e,onClickRemove:a,name:t,images:i}){const[r,s]=(0,Q.RH)(i),o=(0,G.VO)(r,s)===G.KO.loaded;return(0,j.jsxs)("div",{className:V,children:[(0,j.jsx)(A.Oe,{loading:"eager",name:t,images:i,placeholderType:"user",shape:A.Kc.CIRCLE}),(0,j.jsxs)("div",{className:n()(z,{[q]:o}),children:[(0,j.jsx)("button",{className:Z,"aria-haspopup":"true",onClick:e,type:"button",children:(0,j.jsx)(W.D,{variant:"ballad",children:d.ag.get("user.edit-details.choose-photo")})}),(0,j.jsx)("div",{className:n()($,"icon"),children:(0,j.jsx)(B.y,{iconSize:48,"aria-hidden":!0})}),(0,j.jsx)("button",{className:Z,onClick:a,type:"button",children:(0,j.jsx)(W.D,{variant:"ballad",children:d.ag.get("user.edit-details.remove-photo")})})]})]})};var Y=t(1208),ee=t(91695),ae=(t(97599),t(15267),t(43059),t(92228));const te={paths:""},ie={encode(e,a=ae.Writer.create()){for(const t of e.paths)a.uint32(10).string(t);return a},decode(e,a){const t=e instanceof Uint8Array?new ae.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...te};for(r.paths=[];t.pos<i;){const e=t.uint32();if(e>>>3==1)r.paths.push(t.string());else t.skipType(7&e)}return r},fromJSON(e){const a={...te};if(a.paths=[],void 0!==e.paths&&null!==e.paths)for(const t of e.paths)a.paths.push(String(t));return a},fromPartial(e){const a={...te};if(a.paths=[],void 0!==e.paths&&null!==e.paths)for(const t of e.paths)a.paths.push(t);return a},toJSON(e){const a={};return e.paths?a.paths=e.paths.map((e=>e)):a.paths=[],a}};t(69121);var re=t(29168),se=t(55872).lW;const oe={value:0},le={value:!1},ne={value:""};const de={encode:(e,a=ae.Writer.create())=>(a.uint32(8).int32(e.value),a),decode(e,a){const t=e instanceof Uint8Array?new ae.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...oe};for(;t.pos<i;){const e=t.uint32();if(e>>>3==1)r.value=t.int32();else t.skipType(7&e)}return r},fromJSON(e){const a={...oe};return void 0!==e.value&&null!==e.value?a.value=Number(e.value):a.value=0,a},fromPartial(e){const a={...oe};return void 0!==e.value&&null!==e.value?a.value=e.value:a.value=0,a},toJSON(e){const a={};return void 0!==e.value&&(a.value=e.value),a}},ue={encode:(e,a=ae.Writer.create())=>(a.uint32(8).bool(e.value),a),decode(e,a){const t=e instanceof Uint8Array?new ae.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...le};for(;t.pos<i;){const e=t.uint32();if(e>>>3==1)r.value=t.bool();else t.skipType(7&e)}return r},fromJSON(e){const a={...le};return void 0!==e.value&&null!==e.value?a.value=Boolean(e.value):a.value=!1,a},fromPartial(e){const a={...le};return void 0!==e.value&&null!==e.value?a.value=e.value:a.value=!1,a},toJSON(e){const a={};return void 0!==e.value&&(a.value=e.value),a}},ce={encode:(e,a=ae.Writer.create())=>(a.uint32(10).string(e.value),a),decode(e,a){const t=e instanceof Uint8Array?new ae.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...ne};for(;t.pos<i;){const e=t.uint32();if(e>>>3==1)r.value=t.string();else t.skipType(7&e)}return r},fromJSON(e){const a={...ne};return void 0!==e.value&&null!==e.value?a.value=String(e.value):a.value="",a},fromPartial(e){const a={...ne};return void 0!==e.value&&null!==e.value?a.value=e.value:a.value="",a},toJSON(e){const a={};return void 0!==e.value&&(a.value=e.value),a}};ae.util.Long!==re&&(ae.util.Long=re,(0,ae.configure)());const me=globalThis;me.atob,me.btoa;const ge={maxWidth:0,maxHeight:0,url:""},pe={},he={},fe={encode:(e,a=ae.Writer.create())=>(a.uint32(8).int32(e.maxWidth),a.uint32(16).int32(e.maxHeight),a.uint32(26).string(e.url),a),decode(e,a){const t=e instanceof Uint8Array?new ae.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...ge};for(;t.pos<i;){const e=t.uint32();switch(e>>>3){case 1:r.maxWidth=t.int32();break;case 2:r.maxHeight=t.int32();break;case 3:r.url=t.string();break;default:t.skipType(7&e)}}return r},fromJSON(e){const a={...ge};return void 0!==e.maxWidth&&null!==e.maxWidth?a.maxWidth=Number(e.maxWidth):a.maxWidth=0,void 0!==e.maxHeight&&null!==e.maxHeight?a.maxHeight=Number(e.maxHeight):a.maxHeight=0,void 0!==e.url&&null!==e.url?a.url=String(e.url):a.url="",a},fromPartial(e){const a={...ge};return void 0!==e.maxWidth&&null!==e.maxWidth?a.maxWidth=e.maxWidth:a.maxWidth=0,void 0!==e.maxHeight&&null!==e.maxHeight?a.maxHeight=e.maxHeight:a.maxHeight=0,void 0!==e.url&&null!==e.url?a.url=e.url:a.url="",a},toJSON(e){const a={};return void 0!==e.maxWidth&&(a.maxWidth=e.maxWidth),void 0!==e.maxHeight&&(a.maxHeight=e.maxHeight),void 0!==e.url&&(a.url=e.url),a}},ve={encode(e,a=ae.Writer.create()){void 0!==e.username&&void 0!==e.username&&ce.encode({value:e.username},a.uint32(10).fork()).ldelim(),void 0!==e.name&&void 0!==e.name&&ce.encode({value:e.name},a.uint32(18).fork()).ldelim();for(const t of e.images)fe.encode(t,a.uint32(26).fork()).ldelim();return void 0!==e.verified&&void 0!==e.verified&&ue.encode({value:e.verified},a.uint32(34).fork()).ldelim(),void 0!==e.editProfileDisabled&&void 0!==e.editProfileDisabled&&ue.encode({value:e.editProfileDisabled},a.uint32(42).fork()).ldelim(),void 0!==e.reportAbuseDisabled&&void 0!==e.reportAbuseDisabled&&ue.encode({value:e.reportAbuseDisabled},a.uint32(50).fork()).ldelim(),void 0!==e.abuseReportedName&&void 0!==e.abuseReportedName&&ue.encode({value:e.abuseReportedName},a.uint32(58).fork()).ldelim(),void 0!==e.abuseReportedImage&&void 0!==e.abuseReportedImage&&ue.encode({value:e.abuseReportedImage},a.uint32(66).fork()).ldelim(),void 0!==e.hasSpotifyName&&void 0!==e.hasSpotifyName&&ue.encode({value:e.hasSpotifyName},a.uint32(74).fork()).ldelim(),void 0!==e.hasSpotifyImage&&void 0!==e.hasSpotifyImage&&ue.encode({value:e.hasSpotifyImage},a.uint32(82).fork()).ldelim(),void 0!==e.color&&void 0!==e.color&&de.encode({value:e.color},a.uint32(90).fork()).ldelim(),a},decode(e,a){const t=e instanceof Uint8Array?new ae.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...pe};for(r.images=[];t.pos<i;){const e=t.uint32();switch(e>>>3){case 1:r.username=ce.decode(t,t.uint32()).value;break;case 2:r.name=ce.decode(t,t.uint32()).value;break;case 3:r.images.push(fe.decode(t,t.uint32()));break;case 4:r.verified=ue.decode(t,t.uint32()).value;break;case 5:r.editProfileDisabled=ue.decode(t,t.uint32()).value;break;case 6:r.reportAbuseDisabled=ue.decode(t,t.uint32()).value;break;case 7:r.abuseReportedName=ue.decode(t,t.uint32()).value;break;case 8:r.abuseReportedImage=ue.decode(t,t.uint32()).value;break;case 9:r.hasSpotifyName=ue.decode(t,t.uint32()).value;break;case 10:r.hasSpotifyImage=ue.decode(t,t.uint32()).value;break;case 11:r.color=de.decode(t,t.uint32()).value;break;default:t.skipType(7&e)}}return r},fromJSON(e){const a={...pe};if(a.images=[],void 0!==e.username&&null!==e.username?a.username=String(e.username):a.username=void 0,void 0!==e.name&&null!==e.name?a.name=String(e.name):a.name=void 0,void 0!==e.images&&null!==e.images)for(const t of e.images)a.images.push(fe.fromJSON(t));return void 0!==e.verified&&null!==e.verified?a.verified=Boolean(e.verified):a.verified=void 0,void 0!==e.editProfileDisabled&&null!==e.editProfileDisabled?a.editProfileDisabled=Boolean(e.editProfileDisabled):a.editProfileDisabled=void 0,void 0!==e.reportAbuseDisabled&&null!==e.reportAbuseDisabled?a.reportAbuseDisabled=Boolean(e.reportAbuseDisabled):a.reportAbuseDisabled=void 0,void 0!==e.abuseReportedName&&null!==e.abuseReportedName?a.abuseReportedName=Boolean(e.abuseReportedName):a.abuseReportedName=void 0,void 0!==e.abuseReportedImage&&null!==e.abuseReportedImage?a.abuseReportedImage=Boolean(e.abuseReportedImage):a.abuseReportedImage=void 0,void 0!==e.hasSpotifyName&&null!==e.hasSpotifyName?a.hasSpotifyName=Boolean(e.hasSpotifyName):a.hasSpotifyName=void 0,void 0!==e.hasSpotifyImage&&null!==e.hasSpotifyImage?a.hasSpotifyImage=Boolean(e.hasSpotifyImage):a.hasSpotifyImage=void 0,void 0!==e.color&&null!==e.color?a.color=Number(e.color):a.color=void 0,a},fromPartial(e){const a={...pe};if(a.images=[],void 0!==e.username&&null!==e.username?a.username=e.username:a.username=void 0,void 0!==e.name&&null!==e.name?a.name=e.name:a.name=void 0,void 0!==e.images&&null!==e.images)for(const t of e.images)a.images.push(fe.fromPartial(t));return void 0!==e.verified&&null!==e.verified?a.verified=e.verified:a.verified=void 0,void 0!==e.editProfileDisabled&&null!==e.editProfileDisabled?a.editProfileDisabled=e.editProfileDisabled:a.editProfileDisabled=void 0,void 0!==e.reportAbuseDisabled&&null!==e.reportAbuseDisabled?a.reportAbuseDisabled=e.reportAbuseDisabled:a.reportAbuseDisabled=void 0,void 0!==e.abuseReportedName&&null!==e.abuseReportedName?a.abuseReportedName=e.abuseReportedName:a.abuseReportedName=void 0,void 0!==e.abuseReportedImage&&null!==e.abuseReportedImage?a.abuseReportedImage=e.abuseReportedImage:a.abuseReportedImage=void 0,void 0!==e.hasSpotifyName&&null!==e.hasSpotifyName?a.hasSpotifyName=e.hasSpotifyName:a.hasSpotifyName=void 0,void 0!==e.hasSpotifyImage&&null!==e.hasSpotifyImage?a.hasSpotifyImage=e.hasSpotifyImage:a.hasSpotifyImage=void 0,void 0!==e.color&&null!==e.color?a.color=e.color:a.color=void 0,a},toJSON(e){const a={};return void 0!==e.username&&(a.username=e.username),void 0!==e.name&&(a.name=e.name),e.images?a.images=e.images.map((e=>e?fe.toJSON(e):void 0)):a.images=[],void 0!==e.verified&&(a.verified=e.verified),void 0!==e.editProfileDisabled&&(a.editProfileDisabled=e.editProfileDisabled),void 0!==e.reportAbuseDisabled&&(a.reportAbuseDisabled=e.reportAbuseDisabled),void 0!==e.abuseReportedName&&(a.abuseReportedName=e.abuseReportedName),void 0!==e.abuseReportedImage&&(a.abuseReportedImage=e.abuseReportedImage),void 0!==e.hasSpotifyName&&(a.hasSpotifyName=e.hasSpotifyName),void 0!==e.hasSpotifyImage&&(a.hasSpotifyImage=e.hasSpotifyImage),void 0!==e.color&&(a.color=e.color),a}},xe={encode:(e,a=ae.Writer.create())=>(void 0!==e.mask&&void 0!==e.mask&&ie.encode(e.mask,a.uint32(10).fork()).ldelim(),void 0!==e.userProfile&&void 0!==e.userProfile&&ve.encode(e.userProfile,a.uint32(18).fork()).ldelim(),a),decode(e,a){const t=e instanceof Uint8Array?new ae.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...he};for(;t.pos<i;){const e=t.uint32();switch(e>>>3){case 1:r.mask=ie.decode(t,t.uint32());break;case 2:r.userProfile=ve.decode(t,t.uint32());break;default:t.skipType(7&e)}}return r},fromJSON(e){const a={...he};return void 0!==e.mask&&null!==e.mask?a.mask=ie.fromJSON(e.mask):a.mask=void 0,void 0!==e.userProfile&&null!==e.userProfile?a.userProfile=ve.fromJSON(e.userProfile):a.userProfile=void 0,a},fromPartial(e){const a={...he};return void 0!==e.mask&&null!==e.mask?a.mask=ie.fromPartial(e.mask):a.mask=void 0,void 0!==e.userProfile&&null!==e.userProfile?a.userProfile=ve.fromPartial(e.userProfile):a.userProfile=void 0,a},toJSON(e){const a={};return void 0!==e.mask&&(a.mask=e.mask?ie.toJSON(e.mask):void 0),void 0!==e.userProfile&&(a.userProfile=e.userProfile?ve.toJSON(e.userProfile):void 0),a}},be=`${Y.XA}/identity`;async function ye(e,a,{name:t,imageUploadToken:i}){void 0!==t&&await async function(e,a,t){const i=xe.encode(xe.fromPartial({mask:{paths:["name"]},userProfile:null!==t?{name:t}:{}}));await e.build().withHost(be).withMethod("POST").withPath(`/v3/user/username/${encodeURIComponent((0,ee.C)(a))}`).withEndpointIdentifier("/v3/user/username/{username}").withBody(i.finish()).withoutMarket().send()}(e,a,t),void 0!==i&&(null!==i?await async function(e,a,t){await e.build().withHost(be).withMethod("POST").withPath(`/v3/profile-image/${encodeURIComponent((0,ee.C)(a))}/${t}`).withEndpointIdentifier("/v3/profile-image/{username}/{uploadToken}").withoutMarket().send()}(e,a,i):await async function(e,a){await e.build().withHost(be).withMethod("DELETE").withPath(`/v3/profile-image/${encodeURIComponent((0,ee.C)(a))}`).withEndpointIdentifier("/v3/profile-image/{username}").withoutMarket().send()}(e,a))}var ke=t(39359);const je={type:"error",get message(){return d.ag.get("user.edit-details.error.file-size-exceeded",10)}},Ie={type:"error",get message(){return d.ag.get("user.edit-details.error.too-small",300,300)}},Ne={type:"error",get message(){return d.ag.get("user.edit-details.error.missing-name")}},_e={type:"error",get message(){return d.ag.get("user.edit-details.error.failed-to-save")}},Pe={type:"error",get message(){return d.ag.get("user.edit-details.error.file-upload-failed")}};function we(e){return{type:"setLoading",loading:e}}function Se(e){return{type:"setMessage",message:e}}function Re(e,a){switch(a.type){case"setName":return{...e,name:a.name};case"setMessage":return{...e,message:a.message,loading:!1};case"setLoading":return{...e,loading:a.loading,message:null};case"setImageData":return{...e,imageData:a.data,removeImage:!1};case"setImageToken":return{...e,imageToken:a.token,removeImage:!1};case"removeImage":return{...e,imageToken:void 0,imageData:void 0,image:void 0,removeImage:!0};default:return e}}var Ce=t(43603),Oe=t(31209),Te=t(10771);const Ue="XwNfIrI6_hCa_9_T2cQB",De="so0bdX3oZH6YW5_nGxIR",Ae="aM3plU4zzDqjWlvUHGYb",Ee="zHeo4VUxytwm6Ptr0QyA",Me="vAeyAmeLkDEDKdL9Hou0",Fe="dnmzO6yYKkxUV8jl7O1Z",Le="oN9QVvJKEtdTH3HGfCu1",We="uj7hczcCH1dZpse8Kfmi",He="wvLAEV5wF5C5ej6rvimT",Je="gAQfzAUp1FuSXODeZJfP",Ke="dMhJaxli87_22jb_3d9x",Be="MDb7QhAtHeyM4gKj8j8t",Qe="zGbjZMZ1DTx4futEbN9l",Ge=i.memo((function({uri:e,name:a,image:t,onClose:r,shouldOpenImagePicker:s}){const[o,l]=(0,Oe.Hs)(),[u,c]=function({name:e,image:a}){return(0,i.useReducer)(Re,{loading:!1,message:null,name:e,image:a})}({name:a,image:t}),m=(0,i.useMemo)((()=>{const e=u.imageData||u.image;return e?[{url:e,width:300,height:300}]:[]}),[u.image,u.imageData]);(0,i.useEffect)((()=>{s&&l()}),[l,s]);const g=(0,i.useCallback)((e=>{e===Oe.Hy.FILE_TOO_BIG?c(Se(je)):e===Oe.Hy.IMAGE_TOO_SMALL&&c(Se(Ie))}),[c]),p=(0,i.useCallback)((()=>{c({type:"removeImage"})}),[c]),h=(0,i.useCallback)((async a=>{a.preventDefault();if(0!==u.name.trim().length){c(we(!0));try{const a=u.removeImage?null:u.imageToken;await async function(e,{name:a,imageUploadToken:t}){await ye(ke.b.getInstance(),e,{name:a,imageUploadToken:t})}(e,{name:u.name,imageUploadToken:a}),r({name:u.name,image:u.imageData||u.image})}catch(e){c(Se(_e))}}else c(Se(Ne))}),[c,r,u.image,u.imageData,u.imageToken,u.name,u.removeImage,e]);return(0,j.jsx)(Ce.Z,{isOpen:!0,contentLabel:d.ag.get("user.edit-details.title"),onRequestClose:()=>r(),children:(0,j.jsxs)("div",{className:Ue,children:[(0,j.jsxs)("div",{className:Ae,children:[(0,j.jsx)(W.D,{as:"h1",variant:"canon",children:d.ag.get("user.edit-details.title")}),(0,j.jsx)("button",{className:Ee,onClick:()=>r(),"aria-label":d.ag.get("close"),children:(0,j.jsx)(H.k,{iconSize:16})})]}),u.message&&(0,j.jsx)(Te.X,{isErrorMessage:"error"===u.message.type,message:u.message.message}),(0,j.jsxs)("form",{className:De,onSubmit:h,children:[(0,j.jsx)(Oe.uL,{isOpen:o,minImageWidth:300,minImageHeight:300,maxFileSizeMB:10,onChange:async function(e){if(!e)return;const{imageFile:a,imageDataUrl:t}=e;if(c(Se(null)),c({type:"setImageData",data:t}),a)try{c(we(!0));const e=await async function(e){const a=await ke.b.getInstance().build().withEndpointIdentifier("image-upload/v4/user-profile").withHost("https://image-upload.spotify.com/v4").withMethod("POST").withPath("/user-profile").withBody(e).withoutGlobalHeaders().withHeaders([{key:"Content-Type",value:"image/jpeg"}]).withoutMarket().send();if(!a.body)throw new Error("No upload token recieved");return a.body.uploadToken}(a);c({type:"setImageToken",token:e}),c(we(!1))}catch{c(Se(Pe))}},onError:g}),(0,j.jsxs)("div",{className:Me,children:[(0,j.jsx)(X,{name:a,images:m,onClickEdit:l,onClickRemove:p}),u.loading&&(0,j.jsx)("div",{className:Fe,children:(0,j.jsx)(J.T,{})})]}),(0,j.jsxs)("div",{className:We,children:[(0,j.jsx)("label",{htmlFor:"user-edit-name",className:He,children:(0,j.jsx)(W.D,{variant:"finaleBold",className:Je,children:d.ag.get("user.edit-details.name-label")})}),(0,j.jsx)("input",{"data-testid":"user-edit-name-input",id:"user-edit-name",type:"text",dir:"auto",className:n()(Le,Ke),onChange:e=>{c(function(e){return{type:"setName",name:e}}(e.target.value))},placeholder:d.ag.get("user.edit-details.name-placeholder"),maxLength:32,value:u.name})]}),(0,j.jsx)("div",{className:Be,children:(0,j.jsx)(K.D,{colorSet:"invertedLight",onClick:h,disabled:u.loading,children:d.ag.get("save")})}),(0,j.jsx)(W.D,{as:"p",variant:"finaleBold",className:Qe,children:d.ag.get("image-upload.legal-disclaimer")})]})]})})}));var Ve=t(67008),ze=t(36253),Ze=t(13912),qe=t(76760),$e=t(81186),Xe=t(70326),Ye=t(40192);const ea=({className:e,isCurrentUser:a,userId:t,username:r,userDisplayName:s})=>{const{projects:l,fetchProjects:n}=(0,qe.w)(a,r),u=l?.filter((e=>!(0,Ze.o)(e))),c=l?.filter((e=>(0,Ze.o)(e)&&!e.isPrivate)),m=l?.filter((e=>(0,Ze.o)(e)&&e.isPrivate));return(0,i.useEffect)((()=>{const e=setInterval((()=>{const e=l?.filter((e=>e.publishingState===Xe.H.IN_PROGRESS));e&&e.length>0&&n()}),3e4);return()=>clearInterval(e)}),[n,l]),(0,$e.I)(Ye.O.USER_PROJECTS_UPDATED,(async()=>n())),l?(0,j.jsxs)(j.Fragment,{children:[u.length>0&&(0,j.jsxs)("section",{className:e,children:[(0,j.jsx)(Ve.r,{title:d.ag.get("web-player.soundtrap.unpublished-projects.title"),tagline:d.ag.get("web-player.soundtrap.unpublished-projects.tagline"),seeAllUri:(0,o.QK)(t,["soundtrap","unpublished"]).toURI(),hasMoreElements:u.length>4}),(0,j.jsx)(ze.M,{data:u,userDisplayName:s,isCurrentUser:a,maxNumberOfTracks:4})]}),m.length>0&&(0,j.jsxs)("section",{className:e,children:[(0,j.jsx)(Ve.r,{title:d.ag.get("web-player.soundtrap.private-songs.title"),tagline:d.ag.get("web-player.soundtrap.private-songs.tagline"),seeAllUri:(0,o.QK)(t,["soundtrap","private"]).toURI(),hasMoreElements:m.length>4}),(0,j.jsx)(ze.M,{data:m,userDisplayName:s,isCurrentUser:a,maxNumberOfTracks:4})]}),c.length>0&&(0,j.jsxs)("section",{className:e,children:[(0,j.jsx)(Ve.r,{title:d.ag.get("web-player.soundtrap.public-songs.title"),tagline:a?d.ag.get("web-player.soundtrap.public-songs.tagline"):null,seeAllUri:(0,o.QK)(t,["soundtrap","public"]).toURI(),hasMoreElements:c.length>4}),(0,j.jsx)(ze.M,{data:c,userDisplayName:s,isCurrentUser:a,maxNumberOfTracks:4})]})]}):null};var aa=t(25690),ta=t(16020);var ia=t(92753),ra=t(38402),sa=t(32318),oa=t(15848),la=t(94483),na=t(29977),da=t(15310),ua=t(25270),ca=t(13215),ma=t(35407),ga=t(13034),pa=t(20786);const ha=({imageUriOrUrl:e="",desiredMosaicSize:a=300}={})=>{if(!e)return"";if(e.startsWith("spotify:")){const[,t,...i]=e.split(":");if("image"===t)return`https://i.scdn.co/image/${i[0]}`;if("mosaic"===t)return`https://mosaic.scdn.co/${a}/${i.join("")}`}return e};var fa=t(51841),va=t(24143),xa=t(43980),ba=t(23351),ya=t(68765);const ka=i.memo((function({tracks:e,hasHeaderRow:a=!1,nrTracksVisible:t,uri:r}){const s=(0,ee.C)(r),l=(0,o.qC)(s,"tracks").toURI(),n=(0,i.useMemo)((()=>t?e.slice(0,t):e),[t,e]),{usePlayContextItem:u}=(0,ya.n)({uri:l,pages:[{items:e.map((e=>({type:ta.p.TRACK,uri:e.uri,uid:null,provider:null})))}]},{featureIdentifier:"profile",referrerIdentifier:"user_profile"}),c=(0,i.useCallback)(((e,a)=>{const t=(0,pa.X)(e?.album?.images,{desiredSize:40});return(0,j.jsx)(va.SS,{index:a,uri:(0,xa.$)(e),duration_ms:e.duration_ms,name:e.name,artists:e.artists,album:e.album,isPlayable:!0,isExplicit:!!e.explicit,isMOGEFRestricted:!!e.mogef19,imgUrl:t?.url||"",contextUri:l,usePlayContextItem:u},a+e.uri)}),[l,u]),m=(0,i.useMemo)((()=>[fa.QD.INDEX,fa.QD.TITLE,fa.QD.ALBUM,fa.QD.DURATION]),[]),g=(0,i.useCallback)((e=>e.uri),[]);return(0,j.jsx)(ba.ZP,{value:"user-top-tracks-tracklist",children:(0,j.jsx)(fa.Pv,{ariaLabel:d.ag.get("top_tracks_this_month"),renderRow:c,nrTracks:n.length,tracks:n,resolveUri:g,hasHeaderRow:a,columns:m})})}),((e,a)=>e.tracks===a.tracks)),ja=i.memo((function({tracks:e,title:a,tagline:t,seeAllUri:r,className:s,uri:o,spec:l}){const n=(0,ga.$P)(),d=(0,i.useCallback)((()=>{const e=l.titleLinkFactory().hitUiNavigate({destination:r});n.logInteraction(e)}),[n,r,l]),u=(0,i.useCallback)((()=>{const e=l.titleLinkFactory().hitUiNavigate({destination:r});n.logInteraction(e)}),[n,r,l]);if(!e||0===e.length)return null;const c=e.length>4;return(0,j.jsxs)("section",{className:s,children:[(0,j.jsx)(Ve.r,{title:a,tagline:t,seeAllUri:r,hasMoreElements:c,onClickTitle:d,onClickSeeAll:u}),(0,j.jsx)(ga.Nh,{spec:l,children:(0,j.jsx)(ka,{tracks:e,uri:o,nrTracksVisible:4})})]})}),((e,a)=>e.tracks===a.tracks));function Ia(e,a){switch(a.type){case"OPEN_MODAL":return{isModalOpen:!0,modalVariant:"editProfile",shouldOpenImagePicker:!1};case"OPEN_MODAL_WITH_IMAGEPICKER":return{isModalOpen:!0,modalVariant:"editProfile",shouldOpenImagePicker:!0};case"OPEN_SOUNDTRAP_MODAL":return{isModalOpen:!0,modalVariant:"soundtrap",shouldOpenImagePicker:!1};case"CLOSE_MODAL":return{isModalOpen:!1,modalVariant:null,shouldOpenImagePicker:!1};default:return e}}var Na=t(75198),_a=t(47807),Pa=t(85388);const wa=18e5,Sa=3e5,Ra=({uri:e})=>{const a=(0,_.v9)(da.Gf),t=(0,_.v9)(da.A$),s=(0,_.I0)(),[l,m]=(0,la.H)(e),v=(0,i.useMemo)((()=>(0,pa.X)(t)),[t]),[{isModalOpen:b,modalVariant:y,shouldOpenImagePicker:k},I]=function(){const[e,a]=(0,i.useReducer)(Ia,{isModalOpen:!1,modalVariant:null,shouldOpenImagePicker:!1});return[e,a]}(),N=(0,ia.o)(),W=!(0,sa.k)(),H=(0,ra.g)(),J=(()=>{const e=(0,_.v9)((e=>e.session?.user));return e?{type:ta.p.USER,uri:e.uri,username:e.id,displayName:e.display_name??null,images:e.images.map((({url:e,width:a,height:t})=>({url:e,width:a||void 0,height:t||void 0}))),optInTrialPremiumOnlyMarket:Boolean(e.policies?.opt_in_trial_premium_only_market)}:null})()?.uri,{data:K,loading:B}=(0,g.J)(p.n5.getProfile,[{uri:e,playlists:10,artists:10,episodes:10}],{cacheTime:wa,staleTime:Sa}),Q=K?.public_playlists,G=K?.is_verified,V=!!J&&(0,o.U4)(e,J),z=K?.recently_played_artists,Z=V?v?.url||"":K?.image_url||"",q=(0,ee.C)(e),$=(0,_.v9)(na.C7),X=(V?a:K?.name)||"",Y=(0,oa.Z)(K?.image_url||null),{userId:ae=""}=(0,r.UO)(),{spec:te,logger:ie}=(0,ga.fU)(w.createDesktopProfileEventFactory,{data:{uri:e,identifier:ae}}),re=(0,i.useMemo)((()=>te.sectionTopTracksFactory()),[te]),se=!H&&(!1!==K?.show_follows||V),{data:oe,loading:le}=(0,g.J)(p.n5.getFollowing,[e],{enabled:se,cacheTime:wa,staleTime:Sa}),ne=oe?.profiles,{data:de,loading:ue}=(0,g.J)(p.n5.getFollowers,[e],{enabled:se,cacheTime:wa,staleTime:Sa}),ce=de?.profiles,{data:me,loading:ge}=(0,g.J)(p.n5.getUserTopArtists,[],{enabled:V,cacheTime:wa,staleTime:Sa}),{data:pe,loading:he}=(0,g.J)(p.n5.getUserTopTracks,[],{enabled:V&&!$,cacheTime:wa,staleTime:Sa}),fe=me?.body,ve=pe?.body,xe=(0,P.W6)(Pa.sT,{loadingValue:!1}),{projects:be}=(0,qe.w)(V,ae),[ye,ke]=(0,i.useState)(null),{state:je,pathname:Ie}=(0,r.TH)(),Ne=(0,r.s0)();(0,i.useEffect)((()=>{if(xe&&be&&"soundtrap_publish"===je.referrer&&je.newProjectId){const e=be?.find((e=>e.soundtrapProjectId===je.newProjectId));e&&(ke(e),I({type:"OPEN_SOUNDTRAP_MODAL"}))}}),[je,xe,I,be]);const _e=(0,i.useCallback)((()=>{N({targetUri:e,intent:l?"unfollow":"follow",type:"click"});const a=te.actionBarFactory().followButtonFactory();l?(m(!1),ie.logInteraction(a.hitUnfollow({itemToBeUnfollowed:e}))):(m(!0),ie.logInteraction(a.hitFollow({itemToBeFollowed:e})))}),[l,ie,N,m,te,e]),Pe=(0,i.useCallback)((e=>{I({type:"CLOSE_MODAL"}),e?(s((0,ua.dL)(e.name)),s((0,ua.GR)(e.image?[{url:e.image,height:null,width:null}]:[]))):"soundtrap_publish"===je.referrer&&je.newProjectId&&Ne(Ie,{replace:!0})}),[I,je,s,Ne,Ie]),we=(0,i.useCallback)((()=>{I({type:"OPEN_MODAL"});const e=te.headerFactory().usernameFactory().hitUiReveal();ie.logInteraction(e)}),[ie,I,te]),Se=(0,i.useCallback)((()=>{I({type:"OPEN_MODAL_WITH_IMAGEPICKER"});const e=te.headerFactory().profileImageFactory().hitUiReveal();ie.logInteraction(e)}),[ie,I,te]),Re=(0,i.useMemo)((()=>[{url:Z}]),[Z]),Ce=(0,i.useCallback)((()=>{const e=te.headerFactory().usernameFactory().hitUiReveal();ie.logInteraction(e)}),[ie,te]),Oe=(0,i.useCallback)(((e,a)=>{if(!a)return;const t=te.headerFactory().followersLinkFactory().hitUiNavigate({destination:a});ie.logInteraction(t)}),[ie,te]),Te=(0,i.useCallback)(((e,a)=>{if(!a)return;const t=te.headerFactory().followersLinkFactory().hitUiNavigate({destination:a});ie.logInteraction(t)}),[ie,te]),Ue=(0,i.useCallback)((()=>{const e=te.actionBarFactory().contextMenuButtonFactory().hitUiReveal();ie.logInteraction(e)}),[ie,te]);if(!K||B||le||ue||he||ge)return(0,j.jsx)(c.h,{hasError:!1,errorMessage:d.ag.get("error.not_found.title.page")});const De=n()("contentSpacing",f),Ae=se&&!!ce?.length,Ee=se&&!!ne?.length;return(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)(U.$,{children:X}),(0,j.jsxs)(A.gF,{backgroundColor:Y,children:[(0,j.jsx)(M.W,{children:(0,j.jsx)(F.i,{text:X})}),(0,j.jsx)(ma._,{menu:(0,j.jsx)(T.I,{uri:K.uri}),children:(0,j.jsx)("div",{className:x,children:(0,j.jsx)(D.T,{canEdit:V,name:X,images:Re,onClick:Se,placeholderType:"user",shape:A.Kc.CIRCLE})})}),(0,j.jsxs)(A.sP,{children:[(0,j.jsx)(A.dy,{small:!0,uppercase:!0,children:G?(0,j.jsx)(Na.S,{text:d.ag.get("card.tag.profile")}):d.ag.get("card.tag.profile")}),(0,j.jsx)(ma._,{menu:(0,j.jsx)(T.I,{uri:K.uri}),children:(0,j.jsx)(A.xd,{canEdit:V,editTitle:d.ag.get("playlist.edit-details.title"),onClick:we,children:X})}),(0,j.jsx)(A.QS,{totalFollowers:K.followers_count,totalFollowing:K.following_count,publicPlaylists:K.total_public_playlists_count,userUri:e,onCreatorClick:Ce,onTotalFollowersClick:Oe,onTotalFollowingClick:Te})]})]}),(0,j.jsx)(S.o,{backgroundColor:Y,children:(0,j.jsxs)(S.F,{children:[!V&&(0,j.jsx)(E.r,{children:(0,j.jsx)(L.e,{isFollowing:Boolean(l),onClick:_e,disabled:W})}),(0,j.jsx)(ca.y,{menu:(0,j.jsx)(T.I,{uri:K.uri,onEditProfileCallback:we}),children:(0,j.jsx)(R.z,{label:d.ag.get("more.label.context",X),onClick:Ue})})]})}),(0,j.jsxs)(ga.Nh,{spec:te,children:[xe&&(0,j.jsx)(ea,{className:De,userId:ae,username:q,userDisplayName:X,isCurrentUser:V}),V&&(0,j.jsxs)(j.Fragment,{children:[fe?.items.length&&(0,j.jsx)(_a.q,{className:De,total:fe?.total||0,title:d.ag.get("top_artists_this_month"),tagline:d.ag.get("only_visible_to_you"),seeAllUri:(0,o.QK)(q,["top","artists"]).toURI(),id:"top-artists",index:0,children:fe.items.map(((e,a)=>(0,j.jsx)(C.I,{index:a,uri:e.uri,name:e.name,images:e.images},e.uri)))}),(0,j.jsx)(ja,{className:De,title:d.ag.get("top_tracks_this_month"),tagline:d.ag.get("only_visible_to_you"),seeAllUri:(0,o.QK)(q,["top","tracks"]).toURI(),uri:e,tracks:ve?.items,spec:re})]}),(0,j.jsx)(_a.q,{className:De,total:K.total_public_playlists_count,title:d.ag.get("public_playlists"),seeAllUri:(0,o.QK)(q,["playlists"]).toURI(),id:"playlists",index:1,children:Q?.map(((e,a)=>(0,j.jsx)(O.Z,{index:a,uri:e.uri,name:e.name,images:[{url:ha({imageUriOrUrl:e.image_url}),width:300,height:300}],authorName:e.owner_name,description:e.followers_count?d.ag.get("user.followers",e.followers_count):""},e.uri)))}),z?.length?(0,j.jsx)(_a.q,{className:De,total:z?.length,title:d.ag.get("recently_played_artists"),seeAllUri:(0,o.QK)(q,["recently-played-artists"]).toURI(),id:"recently-played-artists",index:2,children:z?.map(((e,a)=>(0,j.jsx)(C.I,{index:a,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))}):null,Ae?(0,j.jsx)(_a.q,{className:De,title:d.ag.get("followers"),total:ce?.length,seeAllUri:(0,o.QK)(q,["followers"]).toURI(),id:"followers",index:3,children:ce?.map(((e,a)=>(0,j.jsx)(u.P,{index:a,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))}):null,Ee?(0,j.jsx)(_a.q,{className:De,title:d.ag.get("following"),total:ne?.length,seeAllUri:(0,o.QK)(q,["following"]).toURI(),id:"following",index:4,children:ne?.map(((e,a)=>(0,j.jsx)(u.P,{index:a,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))}):null,V&&b&&("editProfile"===y?(0,j.jsx)(Ge,{uri:e,name:X,image:Z,onClose:Pe,shouldOpenImagePicker:k}):"soundtrap"===y&&xe&&ye?(0,j.jsx)(aa.x,{project:ye,userDisplayName:X,onClose:Pe}):null)]})]})},Ca=e=>{const{uri:a}=e,{data:t,loading:i,error:r}=(0,g.J)(p.n5.getPlaylists,[{uri:a}]),{public_playlists:s,total_public_playlists_count:o=0}=t||{};return i?(0,j.jsx)(c.h,{hasError:null!==r,errorMessage:d.ag.get("error.not_found.title.page")}):(0,j.jsx)(m.P,{className:n()("contentSpacing",v),total:o,title:d.ag.get("public_playlists"),showAll:!0,children:s?.map(((e,a)=>(0,j.jsx)(O.Z,{index:a,uri:e.uri,name:e.name,authorName:e.owner_name,description:e.followers_count?d.ag.get("user.followers",e.followers_count):"",images:[{url:ha({imageUriOrUrl:e.image_url}),width:300,height:300}]},e.uri)))})},Oa=e=>{const{uri:a}=e,{data:t,loading:i,error:r}=(0,g.J)(p.n5.getRecentlyPlayedArtists,[{uri:a,limit:50}]),s=t?.artists;return i?(0,j.jsx)(c.h,{hasError:null!==r,errorMessage:d.ag.get("error.not_found.title.page")}):(0,j.jsx)(m.P,{className:n()("contentSpacing",v),total:s?.length,title:d.ag.get("recently_played_artists"),showAll:!0,children:s?.map(((e,a)=>(0,j.jsx)(C.I,{index:a,name:e.name,uri:e.uri,images:[{url:e.image_url}]},e.uri)))})},Ta=()=>{const{data:e,loading:a,error:t}=(0,g.J)(p.n5.getUserTopArtists),i=e?.body;return a?(0,j.jsx)(c.h,{hasError:null!==t,errorMessage:d.ag.get("error.not_found.title.page")}):i?(0,j.jsx)(m.P,{className:n()("contentSpacing",v),total:i.items.length,title:d.ag.get("top_artists_this_month"),tagline:d.ag.get("only_visible_to_you"),showAll:!0,children:i.items.map(((e,a)=>(0,j.jsx)(C.I,{index:a,uri:e.uri,name:e.name,images:e.images},e.uri)))}):null},Ua=({uri:e})=>{const{data:a,loading:t,error:i}=(0,g.J)(p.n5.getProfile,[{uri:e}]);return a&&!t&&(a?.is_current_user||!1)?(0,j.jsx)(Ta,{}):(0,j.jsx)(c.h,{hasError:null!==i,errorMessage:d.ag.get("error.not_found.title.page")})},Da=({uri:e})=>{const{data:a,loading:t,error:i}=(0,g.J)(p.n5.getUserTopTracks,[{offset:0,limit:50}]),r=a?.body;return t?(0,j.jsx)(c.h,{hasError:null!==i,errorMessage:d.ag.get("error.not_found.title.page")}):r?(0,j.jsxs)("div",{className:n()("contentSpacing",v,b),children:[(0,j.jsxs)("div",{className:y,children:[(0,j.jsx)(W.D,{as:"h1",variant:"canon",className:k,children:d.ag.get("top_tracks_this_month")}),(0,j.jsx)(W.D,{as:"p",variant:"mesto",children:d.ag.get("only_visible_to_you")})]}),(0,j.jsx)(ka,{tracks:r.items,uri:e,hasHeaderRow:!0})]}):null},Aa=({uri:e})=>{const{data:a,loading:t,error:i}=(0,g.J)(p.n5.getProfile,[{uri:e}]);return a&&!t&&(a?.is_current_user||!1)?(0,j.jsx)(Da,{uri:e}):(0,j.jsx)(c.h,{hasError:null!==i,errorMessage:d.ag.get("error.not_found.title.page")})};var Ea=t(98633);const Ma=(0,i.memo)((function(){const{userId:e=""}=(0,r.UO)(),a=decodeURIComponent(e),t=(0,o.QK)(a).toURI();return(0,j.jsx)("section",{children:(0,j.jsxs)(r.Z5,{children:[(0,j.jsx)(r.AW,{path:"playlists",element:(0,j.jsx)(Ea.K,{pageId:s.Wg.PROFILE_PLAYLISTS,children:(0,j.jsx)(Ca,{uri:t})})}),(0,j.jsx)(r.AW,{path:"top/tracks",element:(0,j.jsx)(Ea.K,{pageId:s.Wg.PROFILE_TOP_TRACKS,children:(0,j.jsx)(Aa,{uri:t})})}),(0,j.jsx)(r.AW,{path:"top/artists",element:(0,j.jsx)(Ea.K,{pageId:s.Wg.PROFILE_TOP_ARTISTS,children:(0,j.jsx)(Ua,{uri:t})})}),(0,j.jsx)(r.AW,{path:"recently-played-artists",element:(0,j.jsx)(Ea.K,{pageId:s.Wg.PROFILE_RECENTLY_PLAYED_ARTISTS,children:(0,j.jsx)(Oa,{uri:t})})}),(0,j.jsx)(r.AW,{path:"following",element:(0,j.jsx)(Ea.K,{pageId:s.Wg.PROFILE_FOLLOWING,children:(0,j.jsx)(N,{uri:t})})}),(0,j.jsx)(r.AW,{path:"followers",element:(0,j.jsx)(Ea.K,{pageId:s.Wg.PROFILE_FOLLOWERS,children:(0,j.jsx)(I,{uri:t})})}),(0,j.jsx)(r.AW,{path:"/",element:(0,j.jsx)(Ea.K,{pageId:s.Wg.PROFILE,children:(0,j.jsx)(Ra,{uri:t})})})]})})}))},43980:(e,a,t)=>{t.d(a,{$:()=>i});const i=e=>e?.linked_from?.uri||e.uri}}]);
//# sourceMappingURL=xpui-routes-profile.js.map